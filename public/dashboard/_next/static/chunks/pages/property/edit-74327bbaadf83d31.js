(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[327],{4889:function(e,t,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/property/edit",function(){return l(5693)}])},5693:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return k}});var a=l(5893),n=l(1163),s=l(8711),i=l(1768),d=l(1313),r=l(9574),o=l(7385),p=l(8884),c=l(1052),u=l(7294),v=l(5379),y=l(7227),m=l(579),b=l(2175),h=l(240),j=l(4779),x=l(5292),g=l(1192),f=l(9473),N=l(9471),k=()=>{let e=(0,n.useRouter)(),t=(0,f.I0)(),l=e.query.id,[k,_]=(0,u.useState)([]),[w,F]=(0,u.useState)(""),[Z,O]=(0,u.useState)([]),[P,S]=(0,u.useState)([]),[D,E]=(0,u.useState)(null),[T,U]=(0,u.useState)({});(0,u.useEffect)(()=>{try{if(l){let a=async()=>{var a,n,s;let i=await j.Z.get("property",l,!0);if((null==i?void 0:i.status)==200){if(null==i?void 0:i.data){let e=await ((null==i?void 0:null===(n=i.data)||void 0===n?void 0:n.property)||[])[0];e.coordinates={lat:((null==e?void 0:e.coordinates)||[])[0]||0,lng:((null==e?void 0:e.coordinates)||[])[1]||0},U(e||{}),_((null==e?void 0:e.imageUrls)||[]),F((null==e?void 0:null===(s=e.banner)||void 0===s?void 0:s.split("/").pop())||""),E(null==e?void 0:e.videoUrl)}t((0,x.N)(!1)),t((0,g.d)(!0))}else(null==i?void 0:null===(a=i.data)||void 0===a?void 0:a.status)===401&&(t((0,N.gy)()),null==e||e.push("/login"))};a()}}catch(e){t((0,x.N)(!1))}finally{t((0,x.N)(!1))}},[l]);let C=async a=>{t((0,x.N)(!0));try{var n,s,i;let d=new FormData;null==a||delete a.imageUrls,null==a||delete a.bannerUrl,null==a||delete a.images,null==a||delete a.user,(Object.keys(a)||[]).map(e=>{"object"!=typeof a[e]?a[e]&&d.append(e,a[e]):"object"==typeof a[e]&&null!=a[e]&&(Object.keys(a[e])||[]).map(t=>{"object"==typeof a[e][t]?(Object.keys(a[e][t])||[]).map(l=>{a[e][t][l]&&d.append("".concat(e,"[").concat(l,"][]"),a[e][t][l])}):a[e][t]&&d.append("".concat(e,"[]"),a[e][t])})}),d.delete("coordinates[]"),d.delete("banner"),a.coordinates.lat&&a.coordinates.lng&&(d.append("coordinates[]",null===(s=a.coordinates)||void 0===s?void 0:s.lat),d.append("coordinates[]",null===(i=a.coordinates)||void 0===i?void 0:i.lng)),w&&d.append("banner",w),Z.length&&Object.values(Z||{}).map(e=>{d.append("images",e)}),(null==k?void 0:k.length)?k.map((e,t)=>{(null==Z?void 0:Z.length)<=t&&d.append("images[]",e)}):(d.append("images[]",""),d.delete("banner"),d.append("banner","")),Z&&P&&P.map(e=>[d.append("oldImages[]",e)]),D&&d.append("video",D);let r=await j.Z.put("property/update",d,l,!0);(null==r?void 0:r.status)==200?(t((0,x.N)(!1)),t((0,g.d)(!0)),setTimeout(()=>{e.back()},200)):(null==r?void 0:null===(n=r.data)||void 0===n?void 0:n.status)===401&&(t((0,N.gy)()),null==e||e.push("/login"))}catch(e){t((0,x.N)(!1))}finally{t((0,x.N)(!1))}};return(0,a.jsx)("div",{className:"card bg-white",children:(0,a.jsx)("div",{className:"card-datatable",children:(0,a.jsxs)("div",{className:"dataTables_wrapper dt-bootstrap5",children:[(0,a.jsx)(s.ZP,{title:"Edit Property",onAddClick:()=>{e.back()},AddButtonText:"Back",onExportClick:()=>{},disable:[s.bi]}),0!=Object.keys(T).length?(0,a.jsx)(b.J9,{enableReinitialize:!0,onSubmit:C,initialValues:T,validationSchema:h.Z,children:e=>{var t;let{values:l,setValues:n,errors:s}=e;return(0,a.jsx)(b.l0,{children:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"px-5 py-5",children:[(0,a.jsx)(i.Z,{type:v.bk,setData:n,data:l,errors:s}),(0,a.jsx)(d.ZP,{type:v.bk,setData:n,data:l,errors:s}),(null==l?void 0:l.property_type)!=="Plot"&&(null==l?void 0:l.property_type)!=="Farm"&&(0,a.jsx)(r.Z,{type:v.bk,setData:n,data:l,errors:s}),(null==l?void 0:l.property_type)!=="Plot"&&(null==l?void 0:l.property_type)!=="Farm"&&(0,a.jsx)(o.Z,{type:v.bk,setData:n,data:l,errors:s}),(null==l?void 0:l.property_type)!=="Plot"&&(null==l?void 0:l.property_type)!=="Farm"&&(0,a.jsx)(p.Z,{type:v.bk,setData:n,data:l,errors:s}),(null==l?void 0:l.property_type)!=="Plot"&&(null==l?void 0:l.property_type)!=="Farm"&&(0,a.jsx)(c.Z,{type:v.bk,setData:n,data:l,errors:s})]}),(0,a.jsx)(m.Z,{video:D,setVideo:E}),(0,a.jsx)(y.Z,{selectedFile:k,setSelectedFile:_,setFiles:O,Files:Z,setDeletedFile:S,banner:w,setBanner:F}),(0,a.jsx)("div",{className:"mx-2 my-2",children:(null===(t=Object.keys(s||{}))||void 0===t?void 0:t.length)>0&&(0,a.jsx)("div",{className:"p-3",children:(0,a.jsx)("div",{className:"p-3 mb-2 bg-danger text-white",children:"Oops! It seems there's an error in the form submission. Please review the information"})})}),(0,a.jsx)("div",{className:"d-flex h-98 justify-content-center",children:(0,a.jsx)("button",{type:"submit",className:"btn btn-primary mt-5 d-block text-uppercase",children:"Update"})}),(0,a.jsx)("div",{className:"mt-5",children:(0,a.jsx)("pre",{children:JSON.stringify(s,null,1)})})]})})}}):(0,a.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{height:"50vh"},children:(0,a.jsx)("h1",{children:"data Not Found"})})]})})})}}},function(e){e.O(0,[86,255,958,585,544,563,919,774,888,179],function(){return e(e.s=4889)}),_N_E=e.O()}]);